<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- Action fenêtre : tree, form et kanban -->
    <record id="action_tp_tache" model="ir.actions.act_window">
        <field name="name">Tâches TP</field>
        <field name="res_model">tp.tache</field>
        <field name="view_mode">tree,form,kanban</field>
    </record>

    <!-- Menu principal -->
    <menuitem id="menu_tp_root" name="Tâches TP" sequence="10"/>
    <!-- Sous-menu -->
    <menuitem id="menu_tp_taches" name="Gestion des Tâches" parent="menu_tp_root" action="action_tp_tache" sequence="10"/>

    <!-- Vue liste (tree) avec couleurs selon le statut -->
    <record id="view_tp_tache_tree" model="ir.ui.view">
        <field name="name">tp.tache.tree</field>
        <field name="model">tp.tache</field>
        <field name="arch" type="xml">
            <tree decoration-success="statut == 'a_faire'"
                  decoration-warning="statut == 'en_cours'"
                  decoration-danger="statut == 'terminee'">
                <field name="name"/>
                <field name="responsable"/>
                <field name="date_echeance" widget="remaining_days" optional="show"/>
                <field name="priorite"/>
                <field name="statut"/>
            </tree>
        </field>
    </record>

    <!-- Vue formulaire -->
    <record id="view_tp_tache_form" model="ir.ui.view">
        <field name="name">tp.tache.form</field>
        <field name="model">tp.tache</field>
        <field name="arch" type="xml">
            <form>
                <sheet>
                    <group>
                        <field name="name"/>
                        <field name="responsable"/>
                        <field name="date_echeance" widget="remaining_days"/>
                        <field name="priorite"/>
                        <field name="statut"/>
                    </group>
                    <group>
                        <field name="description" placeholder="Description détaillée de la tâche..."/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Vue Kanban (drag & drop par statut) -->
    <record id="view_tp_tache_kanban" model="ir.ui.view">
        <field name="name">tp.tache.kanban</field>
        <field name="model">tp.tache</field>
        <field name="arch" type="xml">
            <kanban default_group_by="statut">
                <field name="name"/>
                <field name="responsable"/>
                <field name="date_echeance"/>
                <field name="priorite"/>
                <field name="statut"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_card oe_kanban_global_click">
                            <div class="oe_kanban_content">
                                <strong class="o_kanban_record_title">
                                    <field name="name"/>
                                </strong>
                                <div><b>Responsable :</b> <field name="responsable"/></div>
                                <div><b>Échéance :</b> <field name="date_echeance" widget="remaining_days"/></div>
                                <div><b>Priorité :</b> <field name="priorite"/></div>
                            </div>
                            <div class="oe_kanban_footer">
                                <div class="o_kanban_record_subtitle">
                                    <field name="statut" widget="badge"
                                           decoration-success="statut == 'a_faire'"
                                           decoration-warning="statut == 'en_cours'"
                                           decoration-danger="statut == 'terminee'"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>
</odoo>
